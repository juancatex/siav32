<?php

namespace App\Http\Controllers;

use Auth;
use App\Socio; 
use App\Adm_User; 
use App\Par_Prestamos;
use App\Glo_SolicitudCargoCuenta;
use Illuminate\Support\Facades\DB;
use Illuminate\Routing\Controller;
use Illuminate\Http\Request;
use PDF;


class apkMovile extends Controller
{

    public function getcarga(Request $request){
        // return DB::connection('dbcarga')->select("SELECT count(*) as suma  FROM finanzas.ptm_ascii where importe>100",array($request->socio))[0]->suma;
        $out = array();  
        $prestamos = DB::connection('pgsql')->select("SELECT m.par_automatico , d.id_transaccion,d.id_tipo  
        FROM finanzas.con_tr_detalles d, finanzas.con_tr_maestro m
        where d.id_transaccion =m.id_transaccion and d.id_tipo =m.id_tipo 
        and ( d.cuenta='41101101' or  d.cuenta='41101103') 
        and (d.fecha_transaccion >=? and d.fecha_transaccion <=?) 
        and m.fecha_revmod is null and m.id_transaccion_revmod is null group by 1,2,3 order by 1,2",array($request->f,$request->f2));
        $sumacuentadaaro=0;
        $sumasincuentadaaro=0;
        $ivacon1=0;
        $ivasin1=0;
        $ivacon2=0;
        $ivasin2=0;

        $porsicon=0;
        $pornocon=0;
        $porsisin=0;
        $pornosin=0;
        
       foreach ($prestamos as $pre) {
              $comprobantee=DB::connection('pgsql')->select(" SELECT m.par_automatico , d.*  
              FROM finanzas.con_tr_detalles d, finanzas.con_tr_maestro m
              where d.id_transaccion =m.id_transaccion and d.id_tipo =m.id_tipo and d.id_transaccion=? AND d.id_tipo=?",array($pre->id_transaccion,$pre->id_tipo));  
             $contador=0; 
             $contadoriva=0; 
             $auto='';

             foreach($comprobantee as $cuentass){
                  if($cuentass->cuenta=='22501101'){
                    $contador++; 
                  } 
                  if($cuentass->cuenta=='21301102'){
                    $contadoriva++;
                  } 
                  $auto=$cuentass->par_automatico;
             }

             if($contador>0){
                $sumacuentadaaro++;
                if($auto=='S'){
                    $porsicon++;
                    if($contadoriva>0){
                        $ivacon1++;
                    }
                }else{
                    $pornocon++;
                    if($contadoriva>0){
                        $ivacon2++;
                    }
                }
                
             }else{
                $sumasincuentadaaro++;
                if($auto=='S'){
                    $porsisin++;
                    if($contadoriva>0){
                        $ivasin1++;
                    }
                }else{
                    $pornosin++;
                    if($contadoriva>0){
                        $ivasin2++;
                    }
                }
                
             } 

        }
        return ['sumacuentadaaro'=>$sumacuentadaaro,
        'automatico'=>$porsicon,
        'ivaautomatico'=>$ivacon1,
        'manual'=>$pornocon, 
        'ivamanual'=>$ivacon2,
        'sumasincuentadaaro'=>$sumasincuentadaaro,
        'automaticos'=>$porsisin,
        'iva_auto'=>$ivasin1,
        'manuals'=>$pornosin,
        'iva_manual'=>$ivasin2]; 
    }
    public function getprueba(Request $request){
        
        return DB::connection('pgsql')->select("SELECT * 
        FROM finanzas.con_tr_detalles
        WHERE id_transaccion='1008' AND id_tipo='SEC_CON_COM_INGRESO'"); 
    }
    public function validarsaldomenorA(Request $request){
        return DB::connection('pgsql')->select("SELECT COALESCE(sum(importe)*-1, 0) as suma 
        FROM finanzas.ptm_acreedores
        WHERE fecha_transaccion='2022-03-15' AND id_canal ='AJ_SMEN' and id_persona =?",array($request->socio))[0]->suma;
    }
    public function validarsaldomenorB(Request $request){
        return DB::connection('pgsql')->select("SELECT count(*) as suma
        FROM finanzas.ptm_tr_contable
        WHERE id_prestamo =? and id_comprobante='222' and contabilizado ='S' and cuenta='51301111' limit 1",array($request->idprestamo))[0]->suma;
    }
    public function validarsaldomenorC(Request $request){
        return DB::connection('pgsql')->select("SELECT * from finanzas.vptm_prestamos 
        where id_prestamo =?",array($request->idprestamo))[0];
    }
    public function gethtml()
    {
        $idsolccuenta=4;
        $sidirectorio=1;

        //dd($sidirectorio);  
        
        $raw=DB::raw('concat(apaterno," ",amaterno," ",nombre) as nombres');
        $raw2=DB::raw('year(con__asientomaestros.fechavalidado) as anio');
        if($sidirectorio)
        {
            $solccuenta=Glo_SolicitudCargoCuenta::join('con__asientomaestros','con__asientomaestros.idasientomaestro','glo__solicitud_cargo_cuentas.idasientomaestro')
                                                    ->join('socios','socios.numpapeleta','glo__solicitud_cargo_cuentas.subcuenta')
                                                    ->join('fil__directivos','fil__directivos.idsocio','socios.idsocio')
                                                    ->join('fil__filials','fil__filials.idfilial','fil__directivos.idfilial')
                                                    ->join('fil__unidads','fil__unidads.idunidad','fil__directivos.idunidad')
                                                    ->join('con__cuentas','con__cuentas.idcuenta','glo__solicitud_cargo_cuentas.idcuentadesembolso')
                                                    ->select('glo__solicitud_cargo_cuentas.glosa',
                                                            'glo__solicitud_cargo_cuentas.monto',
                                                            'glo__solicitud_cargo_cuentas.fecha_desembolso',
                                                            'glo__solicitud_cargo_cuentas.numdocobligacion',
                                                            $raw,$raw2,
                                                            'fil__filials.sigla',
                                                            'fil__unidads.nomcargo',
                                                            'con__cuentas.nomcuenta',
                                                            'con__asientomaestros.cod_comprobante',
                                                            'ci')
                                                    ->where('glo__solicitud_cargo_cuentas.idsolccuenta',$idsolccuenta)
                                                    ->get();
        }
        else
        {    $solccuenta=Glo_SolicitudCargoCuenta::join('con__asientomaestros','con__asientomaestros.idasientomaestro','glo__solicitud_cargo_cuentas.idasientomaestro')
                                                    ->join('rrh__empleados','rrh__empleados.idempleado','glo__solicitud_cargo_cuentas.subcuenta')
                                                    ->join('rrh__cargos','rrh__cargos.idcargo','rrh__empleados.idcargo')
                                                    ->join('con__cuentas','con__cuentas.idcuenta','glo__solicitud_cargo_cuentas.idcuentadesembolso')
                                                    ->select('glo__solicitud_cargo_cuentas.glosa',
                                                            'glo__solicitud_cargo_cuentas.monto',
                                                            'glo__solicitud_cargo_cuentas.fecha_desembolso',
                                                            'glo__solicitud_cargo_cuentas.numdocobligacion',
                                                            $raw,$raw2,
                                                            'rrh__cargos.nomcargo',
                                                            'con__cuentas.nomcuenta',
                                                            'con__asientomaestros.cod_comprobante',
                                                            'ci')
                                                    ->where('glo__solicitud_cargo_cuentas.idsolccuenta',$idsolccuenta)
                                                    ->get();
        
        
        }   
         
        $pdf = PDF::loadView('doc_obligacion', ['solccuenta'=>$solccuenta]); 
        return $pdf->stream('doc_obligacion.pdf');
    }

    public function login2(Request $request) {
        if (Auth::attempt(['username' => $request->user, 'password' => $request->pass])) { 

            $socios=Socio::join ('par_fuerzas','socios.idfuerza','=','par_fuerzas.idfuerza')
            ->join ('par_grados','socios.idgrado','=','par_grados.idgrado') 
            ->join ('par_departamentos','socios.iddepartamentoexpedido','=','par_departamentos.iddepartamento') 
            ->select('par_departamentos.abrvdep','socios.liquidopagable_papeleta','socios.rutafoto','socios.activo',
            'socios.idsocio','socios.nombre','socios.apaterno','socios.amaterno','socios.ci','socios.numpapeleta','par_fuerzas.nomfuerza','par_grados.nomgrado')
            // ->where('socios.idsocio','=',Auth::id())
             ->where('socios.idsocio','=','4143') 
            //->where('socios.idsocio','=','4143')
            ->orderBy('socios.nombre', 'asc')->get()->toArray(); 
            return response()->json(array('data' =>'ok','id' =>$socios[0]['idsocio'],'num' => $socios[0]['numpapeleta'],
            'ruta'=>$socios[0]['rutafoto']==null?'':$socios[0]['rutafoto'],'gra' => $socios[0]['nomgrado'],'nom' =>  $socios[0]['nombre'],'ape' =>$socios[0]['apaterno'] .' '. $socios[0]['amaterno']), 200);
        } else {
            return response()->json('Usuario no encontrado.', 500);
        }
    }
    public function login(Request $request)
    {
    if (!Auth::attempt($request->only('username', 'password'))) {
    return response()->json([
    'message' => 'Datos invalidos'
               ], 401);
           }
    
    $user = Adm_User::where('username', $request['username'])->where('activo',1)->firstOrFail(); 
    $token = $user->createToken('auth_token')->plainTextToken;
     
    return response()->json(array('token' => $token,'token_type' => 'Bearer'), 200);
    }


    public function validate() {
        if (Auth::check()) {
            return response()->json(array('data' =>'ok'), 200);
        } else {
            return response()->json(array('data' =>'error'), 500);
        }
    }
    public function getPrestamos(Request $request){
        $tipo = DB::raw("par__prestamos__tipo__ejecucion.nombre as nombretipo");
        $ascii = DB::raw("(SELECT count(*) FROM par__prestamos__plans pplan where pplan.idprestamo=par__prestamos.idprestamo and pplan.idestado=10) as acsii");
        $socios=Par_Prestamos::select('par__productos.tasa',
        'par__prestamos.detalle_desembolso','par__monedas.codmoneda','par__monedas.nommoneda','par__prestamos.idprestamo',$tipo,$ascii,
        'par__productos.nomproducto','par_grados.nomgrado','socios.nombre','socios.apaterno','socios.amaterno',
        'par__prestamos.monto','par__prestamos.plazo','par__prestamos.fecharegistro','par__prestamos.idestado',
        'par__prestamos__estados.nombreestado','par__prestamos.cuota','par__prestamos.apro_conta')
            ->join ('par__productos','par__prestamos.idproducto','=','par__productos.idproducto')
            ->join ('socios','par__prestamos.idsocio','=','socios.idsocio')
            ->join ('par_grados','socios.idgrado','=','par_grados.idgrado')
            ->join ('par__prestamos__estados','par__prestamos.idestado','=','par__prestamos__estados.idestado')
            ->join ('par__prestamos__tipo__ejecucion','par__prestamos.idejecucion','=','par__prestamos__tipo__ejecucion.idejecucion')
            ->join ('par__monedas','par__productos.moneda','=','par__monedas.idmoneda') 
            ->whereBetween('par__prestamos.idestado',[1,9])
            ->where('par__prestamos.idsocio','=',$request->idsocio)
            ->orderBy('par__prestamos.idestado', 'asc')->get();
        return ['prestamos'=>$socios];
        
    }

    public function verServicios(Request $request)
    {
        $socios ="select nomestablecimiento, substring(codambiente,2,1) as piso, substring(codambiente,4,2) as pieza, 
        concat(fechaentrada,' ',horaentrada) as fechaentrada, CONCAT(fechasalida,' ',horasalida) as fechasalida, concat(alquiler,' Bs.') as precionoche, concepto, 
        periodo, nrdocumento, concat(importe,' Bs.') as importe
        from ser__asignacions 
        join ser__ambientes on ser__ambientes.idambiente=ser__asignacions.idambiente
        join ser__establecimientos on ser__establecimientos.idestablecimiento=ser__ambientes.idestablecimiento
        join ser__pagos on ser__pagos.idasignacion=ser__asignacions.idasignacion
        where idcliente=?"; 
    return ['servicios'=>DB::select($socios, array($request->idsocio))];
    }
    public function verAportes(Request $request)
    {
        $aportes = "select min(a.fechaaporte) as primeraporte,
        max(a.fechaaporte) as ultimoaporte,
        if(c.obligatorios=0,c.cantobligados,c.cantjubilacion) as cantidad,
        if(c.obligatorios=0,c.totalobligados,c.totaljubilacion) as total  
        from apo__aportes a
        join socios b ON
        a.numpapeleta=b.numpapeleta
        join apo__total_aportes c 
        on a.numpapeleta=c.numpapeleta
        where b.idsocio=?";
    return ['aportes'=>DB::select($aportes, array($request->idsocio))];
    }
    public function extractoAportes(Request $request)
    {
        $aportes2 ="SELECT YEAR(apo__aportes.fechaaporte) AS anio,
		MONTH(apo__aportes.fechaaporte) AS mes,
		apo__aportes.aporte AS sumatotal, 
		apo__tipoaportes.descripcion AS tipo
  
                                from `apo__aportes` 
                                inner join `apo__tipoaportes` 
                                on `apo__aportes`.`idtipoaporte` = `apo__tipoaportes`.`idtipoaporte` 
                                JOIN apo__idsaportes a 
                                ON apo__aportes.idaporte=a.idaporte AND apo__aportes.activo=1 AND a.tipodevolucion=0
                                inner join `socios` 
                                on a.`numpapeleta` = `socios`.`numpapeleta` 
                                inner join `con__perfilcuentamaestros` 
                                on `apo__aportes`.`idperfilcuentamaestro` = `con__perfilcuentamaestros`.`idperfilcuentamaestro`  
                               
                                WHERE socios.idsocio=?                    
                                group by `apo__aportes`.`idaporte` 
                                order by `apo__aportes`.`fechaaporte`";
     return ['aportesdetalle'=>DB::select($aportes2, array($request->idsocio))];
    }
    public function getimage(Request $request){
       
    if(empty($request->ruta)){
        return base64_encode(file_get_contents("storage/socio/avatar.png"));
    }else{
        return base64_encode(file_get_contents("storage/socio/".$request->ruta));
    }
    
    }

    public function getrolesxrol(Request $request)
    {
        $rol ="SELECT id_rol, nombrerol FROM admsis.adrol order by nombrerol"; 
        
        $rolesdb=DB::connection('pgsql')->select($rol);
        echo '<table style="border: 1px solid;
        border-collapse: collapse;">';
        foreach($rolesdb as $rol){ 
            echo '<tr style="border: 1px solid;">  
                 <th style="text-align: left;border: 1px solid;">'.$rol->id_rol.'</th>
                 <th colspan="3" style="text-align: center;border: 1px solid;background-color: black;
                 color: white; text-transform: uppercase;font-size: 22px;">Rol: '.$rol->nombrerol.'</th> 
              </tr>';
              $this->getdetailrol($rol->id_rol);
        }
        
        echo '</table>';
    }
    public function getrolesxusuario(Request $request)
    {
         
       if(isset($request->u)){
        $usuarios ="SELECT R.id_rol,R.nombrerol ,U.usuario,U.nombreusuario
        FROM admsis.adusuario U
        INNER JOIN admsis.adrol R ON (U.id_rol=R.id_rol)
        WHERE U.estado=1 and U.usuario =?  
        ORDER BY 2,4";
        $usuariodb=DB::connection('pgsql')->select($usuarios, array($request->u));
       }else{
        $usuarios ="SELECT R.id_rol,R.nombrerol ,U.usuario,U.nombreusuario
        FROM admsis.adusuario U
        INNER JOIN admsis.adrol R ON (U.id_rol=R.id_rol)
        WHERE U.estado=1 
        ORDER BY 2,4";  
        $usuariodb=DB::connection('pgsql')->select($usuarios);
       }
        echo '<table style="border: 1px solid;
        border-collapse: collapse;">';
        foreach($usuariodb as $user){ 
            echo '<tr style="border: 1px solid;"> 
                 <th style="text-align: right;border: 1px solid;background-color: #3f51b5;
                 color: white;">'.$user->usuario.'</th> 
                 <th style="text-align: center;border: 1px solid;background-color: #3f51b5;
                 color: white;">Rol: '.$user->nombrerol.'</th> 
                 <th colspan="2" style="text-align: center;border: 1px solid;background-color: #3f51b5;
                 color: white; text-transform: uppercase;font-size: 22px;">User: '.$user->nombreusuario.'</th> 
              </tr>';
              $this->getdetailrol($user->id_rol);
        } 
        if(count($usuariodb)==0){
            echo '<tr style="border: 1px solid;">  
            <th  style="text-align: center;border: 1px solid;background-color: #3f51b5;
            color: white; text-transform: uppercase;font-size: 22px;">Usuario inactivo</th> 
         </tr>'; 
        }
        echo '</table>';
    }
    function getdetailrol($idin){
            $modulos=DB::connection('pgsql')->select('SELECT me.id_modulo,mo.nombremodulo FROM admsis.admenu me, admsis.admodulo mo 
            where me.id_modulo=mo.id_modulo and me.id_rol=? GROUP BY me.id_modulo,mo.nombremodulo', array($idin));
            foreach($modulos as $mod){
                echo '<tr style="border: 1px solid;"> 
                        <th style="text-align: right;border: 1px solid;"></th>
                        <th style="text-align: left;border: 1px solid;">'.$mod->id_modulo.'</th>
                        <th colspan="2" style="text-align: left;border: 1px solid;text-transform: uppercase;font-size: 22px;">Modulo: '.$mod->nombremodulo.'</th> 
                     </tr>';


                     $submodulos=DB::connection('pgsql')->select('SELECT * FROM admsis.admenu WHERE id_rol=? AND id_modulo=? AND nivel=0 ORDER BY columna', array($idin,$mod->id_modulo));
                     foreach($submodulos as $submod){
                         echo '<tr style="border: 1px solid;">  
                                <td style="text-align: right;border: 1px solid;"></td>
                                 <td style="text-align: right;border: 1px solid;    background-color: black;
                                 color: white;">'.$submod->id_menu.'</td>
                                 <td colspan="2" style="text-align: left;border: 1px solid; background-color: #8080803b;">Agrupacion: '.$submod->descripmenu.'</td> 
                              </tr>';
                         


                                $funciones=DB::connection('pgsql')->select('SELECT * FROM admsis.admenu WHERE id_rol=?  AND id_modulo=? AND id_menupadre=?  AND nivel=1 ORDER BY columna,menupos', array($idin,$mod->id_modulo,$submod->id_menu));
                                foreach($funciones as $fun){
                                    echo '<tr style="border: 1px solid;">  
                                            <td style="text-align: right;border: 1px solid;"></td>
                                            <td style="text-align: right;border: 1px solid;"></td>
                                            <td style="text-align: right;border: 1px solid;">'.$fun->id_menu.'</td>
                                            <td style="text-align: left;border: 1px solid;"><b>Submodulo:</b> '.$fun->descripmenu.'</td> 
                                        </tr>';
                                    
                                }
                     }
                
            }
    }
    

    function getdatasocios(){
$listasocios =['22',
'78',
'143',
'264',
'265',
'295',
'387',
'488',
'558',
'587',
'588',
'662',
'667',
'682',
'719',
'730',
'749',
'781',
'824',
'844',
'994',
'999',
'1071',
'1074',
'1220',
'1234',
'1261',
'1308',
'1318',
'1331',
'1371',
'1373',
'1426',
'1455',
'1468',
'1506',
'1549',
'1600',
'1686',
'1807',
'1834',
'1836',
'1855',
'1919',
'1926',
'1965',
'2021',
'2022',
'2079',
'2085',
'2117',
'2129',
'2141',
'2184',
'2191',
'2212',
'2217',
'2222',
'2246',
'2248',
'2251',
'2256',
'2266',
'2275',
'2279',
'2293',
'2315',
'2320',
'2344',
'2391',
'2433',
'2445',
'2448',
'2450',
'2529',
'2535',
'2566',
'2587',
'2728',
'2737',
'2766',
'2770',
'2782',
'2897',
'2914',
'2968',
'2978',
'3007',
'3026',
'3046',
'3079',
'3085',
'3109',
'3116',
'3139',
'3178',
'3251',
'3260',
'3369',
'3382',
'3385',
'3388',
'3393',
'3433',
'3453',
'3485',
'3501',
'3502',
'3541',
'3550',
'3558',
'3596',
'3617',
'3618',
'3624',
'3640',
'3673',
'3691',
'3719',
'3723',
'3743',
'3757',
'3811',
'3820',
'3822',
'3834',
'3838',
'3847',
'3855',
'3856',
'3900',
'3916',
'3923',
'4005',
'4025',
'4086',
'4149',
'4214',
'4262',
'4345',
'4347',
'4364',
'4379',
'4386',
'4399',
'4421',
'4423',
'4464',
'4479',
'4507',
'4527',
'4542',
'4573',
'4575',
'4577',
'4585',
'4596',
'4597',
'4626',
'4629',
'4662',
'4714',
'4717',
'4756',
'4758',
'4770',
'4774',
'4778',
'4789',
'4795',
'4831',
'4844',
'4846',
'4870',
'4873',
'4889',
'4892',
'4897',
'4911',
'5069',
'5159',
'5179',
'5193',
'5203',
'5258',
'5263',
'5265',
'5330',
'5370',
'5381',
'5415',
'5423',
'5444',
'5460',
'5501',
'5602',
'5607',
'5626',
'5838',
'5855',
'5876',
'5926',
'5934',
'5951',
'5966',
'5969',
'5984',
'5991',
'5992',
'6041',
'6111',
'6112',
'6119',
'6150',
'6170',
'6177',
'6227',
'6257',
'6271',
'6273',
'6281',
'6282',
'6338',
'6384',
'6397',
'6475',
'6498',
'6522',
'6528',
'6530',
'6540',
'6547',
'6632',
'6714',
'6796',
'6946',
'6959',
'6978',
'7052',
'7068',
'7069',
'7071',
'7074',
'7078',
'7123',
'7191',
'7220',
'7239',
'7267',
'7298',
'7324',
'7362',
'7428',
'7446',
'7453',
'7599',
'7607',
'7679',
'7702',
'7728',
'7790',
'7840',
'7912',
'7914',
'7916',
'7919',
'7923',
'7928',
'7943',
'7949',
'7957',
'7980',
'8005',
'8080',
'8112',
'8182',
'8282',
'8314',
'8328',
'8358',
'8364',
'8442',
'8445',
'8446',
'8448',
'8454',
'8465',
'8486',
'8523',
'8551',
'8606',
'8639',
'8655',
'8722',
'8776',
'8842',
'8845',
'8869',
'8900',
'8923',
'8995',
'9019',
'9027',
'9067',
'9069',
'9151',
'9266',
'9337',
'9371',
'9430',
'9478',
'9500',
'9547',
'9553',
'9556',
'9569',
'9570',
'9583',
'9595',
'9658',
'9698',
'9755',
'9763',
'9777',
'9812',
'9859',
'9884',
'9907',
'9947',
'9966',
'9969',
'9992',
'10016',
'10046',
'10047',
'10058',
'10095',
'10109',
'10115',
'10116',
'10160',
'10232',
'10267',
'10277',
'10282',
'10307',
'10315',
'10323',
'10347',
'10402',
'10404',
'10409',
'10427',
'10466',
'10477',
'10507',
'10560',
'10636',
'10653',
'10654',
'10696',
'10700',
'10714',
'10804',
'10822',
'10827',
'10832',
'10890',
'10993',
'11016',
'11051',
'11055',
'11063',
'11123',
'11126',
'11143',
'11195',
'11387',
'11415',
'11438',
'11454',
'11463',
'11478',
'11483',
'11493',
'11549',
'11559',
'11562',
'12043',
'12056',
'12059',
'12107',
'12108',
'12169',
'12228',
'12231',
'12241',
'12242',
'12252',
'12254',
'12256',
'12258',
'12259',
'12275',
'12279',
'12286',
'12403',
'12404',
'12411',
'12413',
'12414',
'12416',
'12417',
'12418',
'12423',
'12429',
'12431',
'12433',
'12434',
'12437',
'12438',
'12450',
'12461',
'12462',
'12463',
'12464',
'12469',
'12470',
'12474',
'12475',
'12477',
'12478',
'12531',
'12696',
'12699',
'12703',
'12704',
'12705',
'12706',
'12707',
'12710',
'12711',
'12712',
'12714',
'12716',
'12718',
'12719',
'12721',
'12726',
'12729',
'12731',
'12733',
'12736',
'12742',
'12751',
'12759',
'12760',
'12765',
'12766',
'12769',
'12770',
'12774',
'12776',
'12779',
'12782',
'12938',
'12939',
'12942',
'12944',
'12945',
'12947',
'12950',
'12951',
'12960',
'12961',
'12963',
'12964',
'12982',
'12985',
'12988',
'12996',
'12998',
'13009',
'13010',
'13011',
'13056',
'13070',
'13073',
'13082',
'13086',
'13089',
'13267',
'13273',
'13276',
'13277',
'13279',
'13286',
'13294',
'13312',
'13325',
'13332',
'13339',
'13342',
'13343',
'13357',
'13363',
'13375',
'13386',
'13391',
'13392',
'13393',
'13396',
'13399',
'13401',
'13402',
'13414',
'13420',
'13422',
'13424',
'13425',
'13428',
'13429',
'13432',
'13442',
'13493',
'13495',
'13496',
'13507',
'13511',
'13516',
'13517',
'13523',
'13525',
'13528',
'13529',
'13532',
'13534',
'13536',
'13537',
'13538',
'13543',
'13545',
'13547',
'13551',
'13554',
'13822',
'13846',
'13917',
'13919',
'13923',
'13925',
'13928',
'13929',
'13933',
'13936',
'13937',
'13948',
'13949',
'13955',
'13957',
'13959',
'13961',
'13962',
'13967',
'13974',
'13975',
'13985',
'13987',
'13988',
'13999',
'14000',
'14001',
'14002',
'14015',
'14016',
'14025',
'14036',
'14041',
'14045',
'14197',
'14329',
'14340',
'14343',
'14348',
'14362',
'14366',
'14367',
'14369',
'14376',
'14385',
'14387',
'14389',
'14404',
'14407',
'14411',
'14416',
'14420',
'14428',
'14435',
'14436',
'14444',
'14446',
'14449',
'14453',
'14459',
'14468',
'14471',
'14472',
'14481',
'14484',
'14485',
'14486',
'14492',
'14505',
'14511',
'14515',
'14814',
'14817',
'14818',
'14823',
'14831',
'14834',
'14836',
'14839',
'14856',
'14870',
'14874',
'14875',
'14876',
'14881',
'14882',
'14883',
'14884',
'14887',
'14888',
'14889',
'14891',
'14892',
'14896',
'14897',
'14900',
'14903',
'14905',
'14907',
'14912',
'14915',
'14918',
'14921',
'14925',
'14926',
'14932',
'14937',
'14938',
'14943',
'14944',
'14945',
'14946',
'14948',
'14951',
'14952',
'14955',
'14964',
'14989',
'15014',
'15015',
'15016',
'15117',
'15292',
'15294',
'15295',
'15305',
'15306',
'15308',
'15310',
'15313',
'15315',
'15319',
'15320',
'15324',
'15336',
'15339',
'15340',
'15348',
'15352',
'15356',
'15362',
'15363',
'15367',
'15370',
'15371',
'15374',
'15376',
'15379',
'15381',
'15385',
'15386',
'15388',
'15389',
'15390',
'15391',
'15392',
'15393',
'15395',
'15398',
'15399',
'15400',
'15404',
'15407',
'15409',
'15415',
'15417',
'15420',
'15423',
'15425',
'15434',
'15438',
'15440',
'15447',
'15448',
'15454',
'15455',
'15460',
'15461',
'15469',
'15470',
'15476',
'15479',
'15483',
'15487',
'15496',
'15498',
'15500',
'15501',
'15504',
'15506',
'15508',
'15511',
'15743',
'15746',
'15750',
'15754',
'15762',
'15764',
'15766',
'15769',
'15770',
'15774',
'15776',
'15785',
'15789',
'15791',
'15795',
'15796',
'15799',
'15805',
'15811',
'15815',
'15828',
'15830',
'15831',
'15832',
'15837',
'15839',
'15844',
'15851',
'15859',
'15860',
'15864',
'15867',
'15868',
'15870',
'15872',
'15873',
'15876',
'15878',
'15879',
'15880',
'15882',
'15885',
'15958',
'15962',
'15972',
'15973',
'15978',
'16008',
'16028',
'16031',
'16043',
'16074',
'16075',
'16086',
'16097',
'16099',
'16176',
'16327',
'16414',
'16514',
'16517',
'16518',
'16519',
'16522',
'16524',
'16525',
'16527',
'16528',
'16534',
'16541',
'16546',
'16547',
'16548',
'16553',
'16554',
'16561',
'16563',
'16567',
'16570',
'16575',
'16576',
'16579',
'16584',
'16586',
'16590',
'16595',
'16601',
'16604',
'16608',
'16613',
'16617',
'16618',
'16673',
'16676',
'16683',
'16684',
'16690',
'16691',
'16696',
'16697',
'16700',
'16704',
'16707',
'16710',
'16711',
'16713',
'16715',
'16716',
'16720',
'16723',
'16725',
'16728',
'16731',
'16732',
'16733',
'16739',
'16740',
'16742',
'16744',
'16748',
'16752',
'16753',
'16757',
'16758',
'16760',
'16761',
'16762',
'16763',
'16765',
'16766',
'16768',
'16771',
'16777',
'16778',
'16779',
'16780',
'16785',
'16790',
'16796',
'16805',
'16820',
'16962',
'16963',
'16965',
'16966',
'16968',
'16970',
'16974',
'16978',
'16980',
'16983',
'16985',
'16986',
'16987',
'17000',
'17002',
'17004',
'17009',
'17012',
'17014',
'17015',
'17018',
'17020',
'17024',
'17025',
'17027',
'17028',
'17035',
'17037',
'17041',
'17044',
'17048',
'17049',
'17063',
'17064',
'17068',
'17070',
'17076',
'17078',
'17082',
'17084',
'17086',
'17088',
'17091',
'17093',
'17095',
'17098',
'17101',
'17104',
'17108',
'17112',
'17117',
'17118',
'17119',
'17126',
'17130',
'17134',
'17136',
'17140',
'17141',
'17143',
'17147',
'17150',
'17152',
'17154',
'17158',
'17172',
'17175',
'17176',
'17178',
'17179',
'17181',
'17192',
'17197',
'17199',
'17201',
'17229',
'17230',
'17231',
'17233',
'17252',
'17254',
'17275',
'17286',
'17287',
'17367',
'17380',
'17381',
'17386',
'17401',
'17405',
'17407',
'17413',
'17414',
'17417',
'17419',
'17420',
'17424',
'17436',
'17437',
'17442',
'17443',
'17446',
'17450',
'17451',
'17453',
'17458',
'17462',
'17465',
'17468',
'17470',
'17475',
'17476',
'17477',
'17479',
'17485',
'17486',
'17494',
'17498',
'17499',
'17502',
'17505',
'17514',
'17520',
'17521',
'17528',
'17540',
'17544',
'17545',
'17550',
'17552',
'17557',
'17559',
'17569',
'17613',
'17616',
'17775',
'17783',
'17787',
'17904',
'17946',
'17949',
'17951',
'17952',
'17956',
'17993',
'18032',
'18037',
'18039',
'18042',
'18043',
'18046',
'18053',
'18054',
'18058',
'18060',
'18063',
'18065',
'18068',
'18071',
'18078',
'18080',
'18084',
'18085',
'18087',
'18091',
'18094',
'18095',
'18096',
'18098',
'18099',
'18100',
'18101',
'18103',
'18107',
'18108',
'18110',
'18111',
'18122',
'18123',
'18129',
'18130',
'18136',
'18138',
'18144',
'18156',
'18158',
'18161',
'18164',
'18167',
'18168',
'18169',
'18171',
'18176',
'18177',
'18178',
'18179',
'18187',
'18189',
'18192',
'18194',
'18198',
'18199',
'18202',
'18208',
'18214',
'18215',
'18216',
'18217',
'18218',
'18220',
'18223',
'18224',
'18225',
'18228',
'18231',
'18233',
'18242',
'18246',
'18265',
'18272',
'18274',
'18276',
'18287',
'18303',
'18471',
'18673',
'18676',
'18677',
'18679',
'18680',
'18682',
'18683',
'18687',
'18688',
'18689',
'18695',
'18699',
'18702',
'18703',
'18705',
'18706',
'18713',
'18714',
'18715',
'18716',
'18721',
'18722',
'18726',
'18727',
'18728',
'18729',
'18734',
'18735',
'18738',
'18740',
'18742',
'18746',
'18749',
'18751',
'18752',
'18756',
'18762',
'18764',
'18765',
'18769',
'18771',
'18775',
'18778',
'18786',
'18787',
'18791',
'18795',
'18796',
'18799',
'18800',
'18802',
'18810',
'18811',
'18813',
'18817',
'18818',
'18819',
'18822',
'18823',
'18824',
'18830',
'18831',
'18832',
'18837',
'18844',
'18852',
'18856',
'18858',
'18859',
'18869',
'18871',
'18874',
'18880',
'18884',
'18889',
'18893',
'18900',
'19013',
'19125',
'19127',
'19146',
'19152',
'19154',
'19184',
'19217',
'19236',
'19301',
'19303',
'19306',
'19313',
'19314',
'19315',
'19321',
'19322',
'19324',
'19325',
'19326',
'19328',
'19329',
'19330',
'19331',
'19332',
'19337',
'19338',
'19339',
'19343',
'19346',
'19347',
'19356',
'19357',
'19358',
'19359',
'19361',
'19365',
'19366',
'19368',
'19369',
'19371',
'19372',
'19375',
'19377',
'19379',
'19380',
'19381',
'19382',
'19383',
'19384',
'19385',
'19386',
'19387',
'19388',
'19390',
'19391',
'19392',
'19393',
'19396',
'19398',
'19404',
'19407',
'19408',
'19409',
'19413',
'19416',
'19418',
'19419',
'19420',
'19426',
'19428',
'19429',
'19431',
'19434',
'19435',
'19441',
'19444',
'19452',
'19458',
'19459',
'19460',
'19461',
'19463',
'19464',
'19465',
'19470',
'19478',
'19479',
'19481',
'19485',
'19486',
'19487',
'19488',
'19489',
'19493',
'19495',
'19496',
'19497',
'19498',
'19500',
'19502',
'19503',
'19508',
'19510',
'19511',
'19514',
'19515',
'19516',
'19519',
'19521',
'19523',
'19526',
'19529',
'19531',
'19536',
'19540',
'19541',
'19544',
'19547',
'19549',
'19551',
'19552',
'19553',
'19556',
'19558',
'19559',
'19561',
'19568',
'19571',
'19647',
'19687',
'19688',
'19689',
'19692',
'19695',
'19696',
'19697',
'19698',
'19701',
'19702',
'19705',
'19706',
'19707',
'19710',
'19716',
'19717',
'19720',
'19721',
'19722',
'19723',
'19724',
'19725',
'19726',
'19730',
'19733',
'19740',
'19742',
'19745',
'19748',
'19749',
'19752',
'19754',
'19755',
'19756',
'19758',
'19762',
'19765',
'19766',
'19767',
'19770',
'19771',
'19772',
'19773',
'19776',
'19777',
'19780',
'19781',
'19782',
'19783',
'19785',
'19787',
'19789',
'19790',
'19792',
'19793',
'19797',
'19800',
'19801',
'19805',
'19807',
'19813',
'19814',
'19815',
'19816',
'19820',
'19953',
'19954',
'19955',
'19957',
'19960',
'19961',
'19962',
'19969',
'19972',
'19973',
'19974',
'19977',
'19980',
'19981',
'19982',
'19986',
'19989',
'19992',
'19993',
'19994',
'19997',
'19999',
'20001',
'20003',
'20004',
'20005',
'20009',
'20011',
'20014',
'20016',
'20020',
'20021',
'20022',
'20023',
'20027',
'20028',
'20030',
'20032',
'20034',
'20040',
'20042',
'20044',
'20046',
'20048',
'20053',
'20054',
'20056',
'20058',
'20064',
'20117',
'20120',
'20122',
'20124',
'20127',
'20130',
'20131',
'20138',
'20143',
'20146',
'20156',
'20159',
'20160',
'20163',
'20164',
'20165',
'20167',
'20169',
'20173',
'20175',
'20322',
'20324',
'20325',
'20336',
'20346',
'20348',
'20355',
'20356',
'20359',
'20360',
'20367',
'20369',
'20370',
'20374',
'20379',
'20382',
'20384',
'20387',
'20389',
'20390',
'20392',
'20394',
'20395',
'20396',
'20402',
'20405',
'20408',
'20413',
'20414',
'20416',
'20419',
'20424',
'20428',
'20431',
'20440',
'20441',
'20517',
'20651',
'20666',
'20668',
'20672',
'20678',
'20679',
'20685',
'20686',
'20687',
'20698',
'20701',
'20702',
'20704',
'20705',
'20707',
'20712',
'20713',
'20714',
'20715',
'20718',
'20722',
'20723',
'20725',
'20726',
'20727',
'20729',
'20730',
'20733',
'20737',
'20741',
'20744',
'20747',
'20748',
'20749',
'20750',
'20751',
'20753',
'20758',
'20762',
'20763',
'20764',
'20765',
'20766',
'20768',
'20773',
'20774',
'20783',
'20784',
'20787',
'20788',
'20790',
'20791',
'20792',
'20795',
'20856',
'21154',
'21158',
'21161',
'21163',
'21165',
'21166',
'21167',
'21168',
'21170',
'21172',
'21174',
'21176',
'21179',
'21181',
'21182',
'21185',
'21186',
'21188',
'21191',
'21193',
'21195',
'21196',
'21198',
'21200',
'21201',
'21204',
'21205',
'21210',
'21213',
'21215',
'21217',
'21218',
'21219',
'21226',
'21227',
'21231',
'21232',
'21236',
'21237',
'21240',
'21243',
'21244',
'21245',
'21246',
'21247',
'21250',
'21253',
'21255',
'21256',
'21257',
'21258',
'21259',
'21260',
'21261',
'21262',
'21263',
'21272',
'21274',
'21279',
'21281',
'21284',
'21285',
'21286',
'21288',
'21289',
'21292',
'21293',
'21294',
'21296',
'21297',
'21308',
'21310',
'21314',
'21318',
'21322',
'21324',
'21326',
'21327',
'21329',
'21334',
'21335',
'21336',
'21337',
'21338',
'21341',
'21345',
'21346',
'21355',
'21356',
'21357',
'21361',
'21362',
'21363',
'21364',
'21417',
'21420',
'21424',
'21433',
'21438',
'21439',
'21444',
'21445',
'21446',
'21448',
'21458',
'21459',
'21462',
'21471',
'21474',
'21475',
'21477',
'21480',
'21481',
'21483',
'21488',
'21489',
'21491',
'21492',
'21495',
'21496',
'21497',
'21498',
'21501',
'21502',
'21657',
'21660',
'21661',
'21665',
'21670',
'21681',
'21686',
'21690',
'21693',
'21697',
'21702',
'21704',
'21706',
'21707',
'21709',
'21711',
'21713',
'21716',
'21719',
'21730',
'21736',
'21748',
'21751',
'21753',
'21754',
'21756',
'21772',
'21777',
'21780',
'21797',
'21806',
'21807',
'21809',
'21812',
'21813',
'21815',
'21816',
'21817',
'21821',
'21824',
'21826',
'21827',
'21831',
'21840',
'21845',
'21846',
'21852',
'21857',
'21858',
'21863',
'21864',
'21865',
'21868',
'21872',
'21873',
'21879',
'21884',
'21892',
'21894',
'21921',
'21929',
'21941',
'21943',
'21947',
'21949',
'21953',
'21955',
'21958',
'21959',
'21960',
'21961',
'21963',
'21964',
'21966',
'21968',
'21969',
'21973',
'21975',
'21977',
'21979',
'21980',
'21983',
'22033',
'22034',
'22040',
'22042',
'22045',
'22051',
'22052',
'22056',
'22057',
'22059',
'22061',
'22063',
'22064',
'22065',
'22067',
'22074',
'22080',
'22084',
'22087',
'22100',
'22101',
'22108',
'22114',
'22118',
'22152',
'22287',
'22295',
'22312',
'22319',
'22321',
'22322',
'22331',
'22335',
'22338',
'22343',
'22349',
'22356',
'22357',
'22365',
'22367',
'22397',
'22398',
'22399',
'22400',
'22402',
'22403',
'22404',
'22409',
'22410',
'22411',
'22420',
'22428',
'22432',
'22434',
'22436',
'22439',
'22466',
'22467',
'22469',
'22476',
'22477',
'22485',
'22498',
'22512',
'22538',
'22545',
'22552',
'22561',
'22567',
'22569',
'22571',
'22572',
'22576',
'22582',
'22584',
'22586',
'22589',
'22590',
'22591',
'22594',
'22595',
'22596',
'22600',
'22602',
'22604',
'22605',
'22607',
'22608',
'22610',
'22620',
'22622',
'22653',
'22656',
'22658',
'22663',
'22666',
'22667',
'22668',
'22671',
'22677',
'22679',
'22681',
'22685',
'22686',
'22687',
'22688',
'22689',
'22691',
'22693',
'22695',
'22699',
'22701',
'22703',
'22704',
'22708',
'22709',
'22710',
'22711',
'22714',
'22716',
'22719',
'22720',
'22722',
'22724',
'22728',
'22731',
'22732',
'22737',
'22740',
'22741',
'22745',
'22748',
'22752',
'22754',
'22756',
'22757',
'22758',
'22759',
'22762',
'22763',
'22764',
'22768',
'22771',
'23179',
'23180',
'23182',
'23183',
'23185',
'23186',
'23188',
'23190',
'23194',
'23196',
'23197',
'23198',
'23200',
'23202',
'23203',
'23207',
'23208',
'23212',
'23213',
'23214',
'23215',
'23216',
'23218',
'23219',
'23220',
'23221',
'23222',
'23223',
'23224',
'23227',
'23228',
'23229',
'23231',
'23233',
'23234',
'23235',
'23236',
'23237',
'23239',
'23240',
'23242',
'23245',
'23246',
'23248',
'23249',
'23250',
'23251',
'23252',
'23253',
'23254',
'23259',
'23261',
'23263',
'23265',
'23268',
'23269',
'23272',
'23275',
'23277',
'23280',
'23281',
'23282',
'23284',
'23285',
'23287',
'23288',
'23289',
'23291',
'23295',
'23296',
'23299',
'23302',
'23304',
'23305',
'23314',
'23316',
'23319',
'23322',
'23323',
'23328',
'23333',
'23337',
'23338',
'23339',
'23340',
'23352',
'23357',
'23358',
'23359',
'23363',
'23419',
'23422',
'23426',
'23432',
'23434',
'23445',
'23446',
'23448',
'23452',
'23459',
'23466',
'23899',
'23902',
'23905',
'23906',
'23908',
'23909',
'23910',
'23912',
'23916',
'23921',
'23922',
'23924',
'23926',
'23928',
'23932',
'23934',
'23935',
'23936',
'23940',
'23948',
'23949',
'23950',
'23954',
'23955',
'23957',
'23959',
'23961',
'23962',
'23963',
'23966',
'23967',
'23975',
'23978',
'23980',
'23981',
'23985',
'23989',
'23994',
'23999',
'24002',
'24003',
'24004',
'24005',
'24007',
'24012',
'24014',
'24015',
'24016',
'24019',
'24026',
'24027',
'24031',
'24032',
'24033',
'24036',
'24037',
'24039',
'24041',
'24047',
'24052',
'24053',
'24055',
'24056',
'24057',
'24058',
'24060',
'24061',
'24062',
'24072',
'24074',
'24124',
'24132',
'24136',
'24157',
'24159',
'24167',
'24168',
'24171',
'24174',
'24181',
'24183',
'24185',
'24575',
'24576',
'24577',
'24579',
'24580',
'24581',
'24584',
'24585',
'24586',
'24587',
'24588',
'24589',
'24590',
'24592',
'24593',
'24597',
'24598',
'24600',
'24603',
'24604',
'24608',
'24614',
'24615',
'24617',
'24618',
'24620',
'24621',
'24622',
'24623',
'24624',
'24625',
'24626',
'24627',
'24629',
'24631',
'24632',
'24633',
'24636',
'24639',
'24640',
'24641',
'24642',
'24644',
'24646',
'24647',
'24651',
'24652',
'24654',
'24655',
'24659',
'24660',
'24661',
'24663',
'24665',
'24669',
'24673',
'24674',
'24675',
'24676',
'24677',
'24683',
'24685',
'24689',
'24690',
'24695',
'24696',
'24697',
'24699',
'24701',
'24703',
'24704',
'24705',
'24707',
'24708',
'24711',
'24713',
'24714',
'24715',
'24716',
'24717',
'24718',
'24720',
'24721',
'24722',
'24726',
'24729',
'24730',
'24731',
'24734',
'24736',
'24738',
'24741',
'24742',
'24745',
'24747',
'24749',
'24750',
'24757',
'24758',
'24760',
'24761',
'24763',
'24765',
'24766',
'24770',
'24771',
'24773',
'24774',
'24775',
'24776',
'24778',
'24779',
'24783',
'24785',
'24787',
'24790',
'24795',
'24846',
'24848',
'24853',
'24856',
'24857',
'24863',
'24865',
'24868',
'24875',
'24877',
'24880',
'24885',
'24887',
'24889',
'24895',
'24897',
'24900',
'25308',
'25309',
'25311',
'25313',
'25318',
'25319',
'25320',
'25321',
'25322',
'25323',
'25325',
'25326',
'25327',
'25328',
'25329',
'25330',
'25332',
'25336',
'25338',
'25341',
'25342',
'25343',
'25346',
'25348',
'25350',
'25351',
'25352',
'25353',
'25354',
'25355',
'25356',
'25357',
'25358',
'25359',
'25360',
'25362',
'25363',
'25364',
'25365',
'25366',
'25370',
'25372',
'25373',
'25374',
'25375',
'25377',
'25378',
'25379',
'25380',
'25382',
'25383',
'25384',
'25385',
'25386',
'25387',
'25388',
'25389',
'25390',
'25391',
'25392',
'25393',
'25394',
'25396',
'25398',
'25400',
'25401',
'25402',
'25404',
'25406',
'25408',
'25409',
'25410',
'25411',
'25412',
'25413',
'25415',
'25416',
'25417',
'25419',
'25423',
'25427',
'25429',
'25430',
'25431',
'25435',
'25436',
'25437',
'25438',
'25439',
'25442',
'25444',
'25446',
'25447',
'25448',
'25449',
'25452',
'25453',
'25454',
'25456',
'25458',
'25459',
'25461',
'25462',
'25463',
'25465',
'25468',
'25471',
'25472',
'25474',
'25475',
'25477',
'25478',
'25479',
'25481',
'25483',
'25534',
'25538',
'25539',
'25540',
'25541',
'25542',
'25544',
'25545',
'25546',
'25551',
'25556',
'25557',
'25564',
'25569',
'25571',
'25573',
'25575',
'25579',
'25580',
'25581',
'25584',
'25585',
'25586',
'25589',
'25591',
'25615',
'25711',
'25714',
'25981',
'25984',
'25985',
'25987',
'25988',
'25989',
'25990',
'25992',
'25996',
'25997',
'25998',
'25999',
'26000',
'26001',
'26002',
'26004',
'26005',
'26006',
'26007',
'26008',
'26009',
'26011',
'26012',
'26013',
'26014',
'26015',
'26017',
'26018',
'26019',
'26020',
'26021',
'26022',
'26023',
'26024',
'26026',
'26027',
'26028',
'26029',
'26030',
'26031',
'26033',
'26034',
'26035',
'26036',
'26037',
'26038',
'26039',
'26040',
'26043',
'26044',
'26045',
'26046',
'26047',
'26048',
'26049',
'26051',
'26052',
'26053',
'26059',
'26060',
'26061',
'26062',
'26065',
'26066',
'26067',
'26068',
'26069',
'26070',
'26071',
'26072',
'26073',
'26074',
'26075',
'26076',
'26078',
'26080',
'26083',
'26084',
'26085',
'26090',
'26091',
'26092',
'26093',
'26094',
'26098',
'26099',
'26100',
'26101',
'26102',
'26103',
'26104',
'26108',
'26110',
'26111',
'26112',
'26113',
'26114',
'26116',
'26117',
'26119',
'26120',
'26121',
'26122',
'26123',
'26124',
'26125',
'26127',
'26128',
'26132',
'26135',
'26137',
'26138',
'26142',
'26144',
'26149',
'26150',
'26151',
'26152',
'26154',
'26155',
'26156',
'26159',
'26207',
'26208',
'26209',
'26210',
'26211',
'26213',
'26215',
'26216',
'26219',
'26222',
'26224',
'26226',
'26227',
'26228',
'26229',
'26235',
'26236',
'26237',
'26241',
'26242',
'26246',
'26247',
'26248',
'26249',
'26251',
'26256',
'26259',
'26260',
'26261',
'26262',
'26263',
'26264',
'26265',
'26545',
'26546',
'26547',
'26548',
'26550',
'26551',
'26552',
'26553',
'26554',
'26555',
'26557',
'26560',
'26561',
'26562',
'26564',
'26565',
'26567',
'26568',
'26571',
'26575',
'26576',
'26577',
'26579',
'26581',
'26582',
'26584',
'26591',
'26592',
'26594',
'26599',
'26601',
'26602',
'26603',
'26604',
'26762',
'26765',
'26767',
'26769',
'26770',
'26771',
'26772',
'26774',
'26775',
'26776',
'26778',
'26779',
'26780',
'26783',
'26784',
'26787',
'26788',
'26789',
'26795',
'26799',
'26800',
'26802',
'26803',
'26804',
'26805',
'26806',
'26807',
'26808',
'26809',
'26810',
'26811',
'26812',
'26814',
'26815',
'26816',
'26819',
'26822',
'26823',
'26825',
'26827',
'26829',
'26830',
'26831',
'26833',
'26834',
'26835',
'26836',
'26838',
'26839',
'26840',
'26841',
'26843',
'26844',
'26846',
'26847',
'26848',
'26850',
'26851',
'26852',
'26854',
'26855',
'26856',
'26857',
'26858',
'26860',
'26861',
'26862',
'26864',
'26868',
'26871',
'26873',
'26876',
'26877',
'26881',
'26882',
'26883',
'26885',
'26886',
'26888',
'26889',
'26892',
'26893',
'26894',
'26895',
'26896',
'26898',
'26899',
'26901',
'26903',
'26904',
'26905',
'26906',
'26907',
'26911',
'26912',
'26913',
'26914',
'26916',
'26918',
'26920',
'26921',
'26923',
'26924',
'26928',
'26930',
'26932',
'26933',
'27233',
'27234',
'27235',
'27237',
'27238',
'27240',
'27243',
'27244',
'27246',
'27247',
'27248',
'27250',
'27251',
'27253',
'27256',
'27257',
'27258',
'27267',
'27268',
'27269',
'27270',
'27274',
'27275',
'27276',
'27277',
'27278',
'27280',
'27281',
'27282',
'27283',
'27284',
'27285',
'27286',
'27288',
'27289',
'27426',
'27427',
'27428',
'27429',
'27431',
'27432',
'27435',
'27436',
'27437',
'27438',
'27439',
'27440',
'27444',
'27447',
'27450',
'27452',
'27453',
'27454',
'27455',
'27457',
'27458',
'27459',
'27460',
'27461',
'27463',
'27464',
'27466',
'27469',
'27470',
'27471',
'27474',
'27476',
'27477',
'27481',
'27482',
'27483',
'27484',
'27485',
'27486',
'27487',
'27490',
'27492',
'27493',
'27495',
'27497',
'27498',
'27499',
'27500',
'27501',
'27502',
'27503',
'27505',
'27506',
'27508',
'27512',
'27514',
'27518',
'27525',
'27526',
'27528',
'27535',
'27536',
'27539',
'27540',
'27543',
'27544',
'27545',
'27551',
'27554',
'27558',
'27560',
'27561',
'27562',
'27565',
'27566',
'27567',
'27569',
'27574',
'27575',
'27579',
'27580',
'27581',
'28035',
'28037',
'28038',
'28039',
'28040',
'28041',
'28042',
'28043',
'28045',
'28046',
'28047',
'28049',
'28052',
'28054',
'28055',
'28056',
'28059',
'28061',
'28063',
'28065',
'28066',
'28070',
'28074',
'28082',
'28084',
'28089',
'28091',
'28092',
'28095',
'28097',
'28098',
'28230',
'28232',
'28233',
'28235',
'28236',
'28237',
'28238',
'28239',
'28240',
'28241',
'28243',
'28244',
'28247',
'28249',
'28250',
'28251',
'28252',
'28254',
'28255',
'28257',
'28260',
'28262',
'28263',
'28264',
'28265',
'28266',
'28267',
'28268',
'28271',
'28272',
'28273',
'28274',
'28275',
'28279',
'28281',
'28282',
'28283',
'28284',
'28285',
'28287',
'28288',
'28291',
'28292',
'28293',
'28294',
'28295',
'28296',
'28297',
'28298',
'28299',
'28300',
'28301',
'28304',
'28306',
'28307',
'28308',
'28309',
'28310',
'28311',
'28313',
'28314',
'28315',
'28316',
'28317',
'28319',
'28320',
'28322',
'28325',
'28326',
'28327',
'28329',
'28330',
'28332',
'28333',
'28334',
'28335',
'28336',
'28337',
'28338',
'28339',
'28340',
'28342',
'28344',
'28345',
'28347',
'28350',
'28351',
'28352',
'28354',
'28355',
'28356',
'28357',
'28360',
'28361',
'28362',
'28363',
'28364',
'28366',
'28369',
'28370',
'28371',
'28372',
'28374',
'28375',
'28376',
'28377',
'28378',
'28379',
'28380',
'28381',
'28382',
'28384',
'28385',
'28386',
'28387',
'28389',
'28391',
'28392',
'28399',
'28400',
'28401',
'28402',
'28403',
'28470',
'28482',
'31200001',
'31200003',
'31200004',
'31200009',
'31200013',
'31200014',
'31200015',
'31200016',
'31200026',
'31200033',
'31201001',
'31201003',
'31201004',
'31201005',
'31201007',
'31201008',
'31201009',
'31201010',
'31201012',
'31201013',
'31201020',
'31201027',
'31201031',
'31202001',
'31202007',
'31202010',
'31202013',
'31202014',
'31202015',
'31202018',
'31202019',
'31202027',
'31202028',
'31202032',
'31202034',
'31202038',
'31203004',
'31203007',
'31203008',
'31203012',
'31203015',
'31203017',
'31203019',
'31203020',
'31203021',
'31203023',
'31203031',
'31203037',
'31204004',
'31204005',
'31204006',
'31204008',
'31204010',
'31204012',
'31204013',
'31204014',
'31204015',
'31204018',
'31204020',
'31204024',
'31204033',
'31204036',
'31204038',
'31204039',
'31204042',
'31204048',
'31205001',
'31205002',
'31205003',
'31205004',
'31205009',
'31205011',
'31205013',
'31205014',
'31205016',
'31205017',
'31205019',
'31205021',
'31205023',
'31205024',
'31205028',
'31205030',
'31205041',
'31206002',
'31206003',
'31206010',
'31206011',
'31206015',
'31206017',
'31206023',
'31206028',
'31206031',
'31206033',
'31206035',
'31206039',
'31206041',
'31206042',
'31206047',
'31206048',
'31206050',
'31206053',
'31206055',
'31206056',
'31206058',
'31206059',
'31206060',
'31206061',
'31206064',
'31206065',
'31206066',
'31206067',
'31206074',
'31206076',
'31206079',
'31206082',
'31206084',
'31206086',
'31206087',
'31206088',
'31206089',
'31206091',
'31206093',
'31206096',
'31206097',
'31206098',
'31207003',
'31207004',
'31207011',
'31207015',
'31207017',
'31207019',
'31207022',
'31207023',
'31207025',
'31207027',
'31207030',
'31207031',
'31207033',
'31207037',
'31207039',
'31207040',
'31207043',
'31207050',
'31207051',
'31207055',
'31207060',
'31207061',
'31207064',
'31207065',
'31207066',
'31207072',
'31207074',
'31207076',
'31207078',
'31207080',
'31207081',
'31208001',
'31208002',
'31208003',
'31208005',
'31208007',
'31208008',
'31208009',
'31208010',
'31208011',
'31208012',
'31208013',
'31208015',
'31208024',
'31208033',
'31208035',
'31208037',
'31208041',
'31208043',
'31208045',
'31208047',
'31208048',
'31208049',
'31208052',
'31208055',
'31208058',
'31208059',
'31208060',
'31208066',
'31208067',
'31208070',
'31208072',
'31208073',
'31208074',
'31208076',
'31208079',
'31208081',
'31208082',
'31208083',
'31208085',
'31208088',
'31209004',
'31209005',
'31209007',
'31209011',
'31209012',
'31209013',
'31209014',
'31209015',
'31209018',
'31209023',
'31209024',
'31209025',
'31209026',
'31209027',
'31209028',
'31209031',
'31209034',
'31209035',
'31209036',
'31209039',
'31209040',
'31209042',
'31209046',
'31209048',
'31209049',
'31209050',
'31209052',
'31209059',
'31209062',
'31209063',
'31210001',
'31210002',
'31210003',
'31210005',
'31210007',
'31210009',
'31210010',
'31210012',
'31210014',
'31210020',
'31210021',
'31210022',
'31210029',
'31210037',
'31210041',
'31210043',
'31210045',
'31210047',
'31211001',
'31211002',
'31211005',
'31211006',
'31211007',
'31211009',
'31211011',
'31211012',
'31211013',
'31211014',
'31211015',
'31211017',
'31211020',
'31211022',
'31211023',
'31211024',
'31211025',
'31211029',
'31211030',
'31211037',
'31211039',
'31211041',
'31211044',
'31211049',
'31211050',
'31211057',
'31211059',
'31211060',
'31212004',
'31212005',
'31212006',
'31212008',
'31212010',
'31212013',
'31212015',
'31212016',
'31212018',
'31212020',
'31212022',
'31212025',
'31212028',
'31212029',
'31212031',
'31212032',
'31212033',
'31212034',
'31212040',
'31212043',
'31212044',
'31212045',
'31212046',
'31212047',
'31212048',
'31212050',
'31212052',
'31212053',
'31212055',
'31212056',
'31212058',
'31212059',
'31212065',
'31212066',
'31212067',
'31212069',
'31212071',
'31212072',
'31213002',
'31213003',
'31213004',
'31213005',
'31213006',
'31213007',
'31213008',
'31213009',
'31213010',
'31213011',
'31213014',
'31213015',
'31213016',
'31213017',
'31213018',
'31213020',
'31213022',
'31213025',
'31213026',
'31213029',
'31213032',
'31213035',
'31213037',
'31213040',
'31213041',
'31213043',
'31213045',
'31213046',
'31213048',
'31213049',
'31213053',
'31213054',
'31213056',
'31213057',
'31213059',
'31213060',
'31213061',
'31213063',
'31213065',
'31213066',
'31213069',
'31213071',
'31213072',
'31213075',
'31213076',
'31214004',
'31214006',
'31214007',
'31214008',
'31214011',
'31214012',
'31214016',
'31214017',
'31214019',
'31214020',
'31214024',
'31214028',
'31214031',
'31214032',
'31214033',
'31214034',
'31214035',
'31214036',
'31214040',
'31214041',
'31214046',
'31214047',
'31214050',
'31214052',
'31214057',
'31214061',
'31214062',
'31214063',
'31214065',
'31214067',
'31215001',
'31215002',
'31215003',
'31215005',
'31215006',
'31215007',
'31215008',
'31215014',
'31215015',
'31215016',
'31215017',
'31215020',
'31215021',
'31215023',
'31215026',
'31215030',
'31215031',
'31215034',
'31215035',
'31215037',
'31215038',
'31215039',
'31215043',
'31215044',
'31215045',
'31215047',
'31215050',
'31215055',
'31215056',
'31215058',
'31215066',
'31216004',
'31216006',
'31216007',
'31216008',
'31216009',
'31216012',
'31216013',
'31216015',
'31216016',
'31216018',
'31216019',
'31216020',
'31216022',
'31216025',
'31216026',
'31216027',
'31216028',
'31216029',
'31216030',
'31216031',
'31216032',
'31216033',
'31216035',
'31216036',
'31216039',
'31216040',
'31216042',
'31216043',
'31216045',
'31216047',
'31216051',
'31216054',
'31216057',
'31216058',
'31216059',
'31216063',
'31216065',
'31216067',
'31216069',
'31216070',
'31216071',
'31216072',
'31216075',
'31216077',
'31217005',
'31217009',
'31217010',
'31217013',
'31217015',
'31217020',
'31217021',
'31217022',
'31217023',
'31217024',
'31217027',
'31217028',
'31217029',
'31217030',
'31217033',
'31217034',
'31217036',
'31217038',
'31217039',
'31217040',
'31217045',
'31217046',
'31218001',
'31218002',
'31218004',
'31218007',
'31218008',
'31218010',
'31218011',
'31218012',
'31218016',
'31218018',
'31218019',
'31218020',
'31218022',
'31218023',
'31218024',
'31218028',
'31218030',
'31218031',
'31218034',
'31218038',
'31219001',
'31219002',
'31219004',
'31219006',
'31219008',
'31219009',
'31219010',
'31219011',
'31219013',
'31219014',
'31219015',
'31219016',
'31219017',
'31219018',
'31219019',
'31219020',
'31219021',
'31219023',
'31219024',
'31219025',
'31219026',
'31219027',
'31219028',
'31219029',
'31219030',
'31219033',
'31219035',
'31219036',
'31219037',
'31219038',
'31219039',
'31219040',
'31219041',
'31219042',
'31219043',
'31219044',
'31219045',
'31219049',
'31219050',
'31219051',
'31219052',
'31219053',
'31220001',
'31220002',
'31220003',
'31220005',
'31220006',
'31220007',
'31220008',
'31220009',
'31220010',
'31220011',
'31220012',
'31220013',
'31220014',
'31220015',
'31220016',
'31220017',
'31220018',
'31220019',
'31220020',
'31220021',
'31220022',
'31220023',
'31220024',
'31220025',
'31220027',
'31220028',
'31220029',
'31220030',
'31220031',
'31220032',
'31220034',
'31220035',
'31220036',
'31220037',
'31220038',
'31220039',
'31220040',
'31220041',
'31220042',
'31220043',
'31220045',
'31220046',
'31220047',
'31220048',
'31220051',
'31220052',
'31220054',
'31221001',
'31221002',
'31221003',
'31221004',
'31221006',
'31221007',
'31221008',
'31221009',
'31221010',
'31221011',
'31221012',
'31221013',
'31221014',
'31221015',
'31221016',
'31221018',
'31221019',
'31221022',
'31221023',
'31221024',
'31221025',
'31221026',
'31221027',
'31221029',
'31221030',
'31221031',
'31221032',
'31221033',
'31221034',
'31221035',
'31221036',
'31221037',
'31221038',
'31221039',
'31221040',
'31221041',
'31221042',
'31221043',
'31221044',
'31221045',
'31221046',
'31221047',
'31221048',
'31221049',
'31221050',
'31221051',
'31221052',
'31221053',
'31221054',
'31221055',
'31221056',
'31221057',
'31221058',
'31221059',
'31221060',
'31221062',
'31221063',
'31221064',
'31221065',
'31221066',
'31279016',
'31282014',
'31287002',
'31287005',
'31287006',
'31287009',
'31287017',
'31287018',
'31287022',
'31287023',
'31288002',
'31288003',
'31288004',
'31288006',
'31288013',
'31288020',
'31288022',
'31288024',
'31288027',
'31288028',
'31288033',
'31288039',
'31288040',
'31288045',
'31288047',
'31288048',
'31288049',
'31288051',
'31288052',
'31288054',
'31289003',
'31289005',
'31289006',
'31289011',
'31289013',
'31289015',
'31289025',
'31289028',
'31289029',
'31289032',
'31289037',
'31289041',
'31289043',
'31289047',
'31289048',
'31289053',
'31289055',
'31289056',
'31289057',
'31289058',
'31290003',
'31290004',
'31290005',
'31290007',
'31290008',
'31290010',
'31290014',
'31290017',
'31290018',
'31290019',
'31290021',
'31290022',
'31290023',
'31290030',
'31290031',
'31290032',
'31290034',
'31290037',
'31290038',
'31290042',
'31290046',
'31290047',
'31290052',
'31290053',
'31290054',
'31290057',
'31290062',
'31291004',
'31291005',
'31291008',
'31291009',
'31291012',
'31291014',
'31291021',
'31291022',
'31291025',
'31291026',
'31291027',
'31291032',
'31291033',
'31291034',
'31291035',
'31291039',
'31291040',
'31291041',
'31291045',
'31291051',
'31291053',
'31291054',
'31291055',
'31292003',
'31292005',
'31292009',
'31292011',
'31292014',
'31292015',
'31292018',
'31292019',
'31292022',
'31292033',
'31292034',
'31292037',
'31292038',
'31292040',
'31292041',
'31292042',
'31292051',
'31292054',
'31292055',
'31292056',
'31292060',
'31292062',
'31292064',
'31292068',
'31292071',
'31292073',
'31292074',
'31293001',
'31293002',
'31293004',
'31293008',
'31293009',
'31293010',
'31293013',
'31293014',
'31293018',
'31293019',
'31293020',
'31293021',
'31293022',
'31293023',
'31293024',
'31293025',
'31293026',
'31293027',
'31293028',
'31293032',
'31293035',
'31293041',
'31293043',
'31293045',
'31293047',
'31293049',
'31293050',
'31293051',
'31293058',
'31294004',
'31294005',
'31294006',
'31294013',
'31294014',
'31294018',
'31294019',
'31294021',
'31294022',
'31294024',
'31294026',
'31294027',
'31294029',
'31294030',
'31294031',
'31294033',
'31295002',
'31295004',
'31295006',
'31295007',
'31295008',
'31295009',
'31295010',
'31295011',
'31295017',
'31295018',
'31295019',
'31295020',
'31295022',
'31295023',
'31295025',
'31295026',
'31295027',
'31295029',
'31295030',
'31295033',
'31295034',
'31296002',
'31296005',
'31296007',
'31296009',
'31296012',
'31296013',
'31296014',
'31296015',
'31296017',
'31296026',
'31297003',
'31297004',
'31297007',
'31297019',
'31297021',
'31297027',
'31297032',
'31297033',
'31298001',
'31298003',
'31298005',
'31298007',
'31298008',
'31298009',
'31298013',
'31298015',
'31298021',
'31298023',
'31298024',
'31298027',
'31298037',
'31299002',
'31299006',
'31299007',
'31299012',
'31299013',
'31299014',
'31299021',
'31299026',
'31299028',
'31299030',
'31299032',
'31299034',
'31299043',
'31299045',
'31588002',
'31904001',
'31906002',
'31908002',
'31909001',
'31911002',
'31995001',
'31995002',
'32206001',
'32206003',
'32206008',
'32206017',
'32206018',
'32206019',
'32206020',
'32207004',
'32208002',
'32208004',
'32208005',
'32208007',
'32208012',
'32208014',
'32209002',
'32209003',
'32209004',
'32209005',
'32210001',
'32210002',
'32210006',
'32210009',
'32211001',
'32211002',
'32211003',
'32211005',
'32211006',
'32211008',
'32212002',
'32212006',
'32212009',
'32213003',
'32213004',
'32213009',
'32213010',
'32213013',
'32214001',
'32214002',
'32214008',
'32214009',
'32215002',
'32215003',
'32215006',
'32215011',
'32215012',
'32215014',
'32215015',
'32215016',
'32215021',
'32215024',
'32215025',
'32215026',
'32215028',
'32215029',
'32215031',
'32215033',
'32215035',
'32215037',
'32215039',
'32215040',
'32216001',
'32216005',
'32216006',
'32216007',
'32216009',
'32216010',
'32216012',
'32216013',
'32216015',
'32216017',
'32216019',
'32216020',
'32216027',
'32216028',
'32216029',
'32216031',
'32217001',
'32217003',
'32217005',
'32217011',
'32217012',
'32217015',
'32217016',
'32217017',
'32217018',
'32217019',
'32217021',
'32218001',
'32218002',
'32218003',
'32218004',
'32218005',
'32218006',
'32218008',
'32218009',
'32218011',
'32218014',
'32218015',
'32218017',
'32218018',
'32218019',
'32218020',
'32218023',
'32218024',
'32218025',
'32218026',
'32219001',
'32219002',
'32219003',
'32219004',
'32219007',
'32219008',
'32219010',
'32219012',
'32219013',
'32219015',
'32219016',
'32219017',
'32219018',
'32219019',
'32219021',
'32219022',
'32219023',
'32219024',
'32219026',
'32219027',
'32219028',
'32220005',
'32220008',
'32220009',
'32220010',
'32221001',
'32221003',
'32221005',
'32221006',
'32221007',
'32221008',
'32221009',
'32221010',
'32221011',
'32221012',
'32221013',
'32221015',
'32221016',
'32221017',
'32221018',
'32221019',
'32221020',
'32221021',
'32275010',
'32291001',
'32291002',
'32291003',
'32291005',
'32291006',
'32291009',
'32291016',
'32293001',
'32293003',
'32293005',
'32293007',
'32293010',
'32296006',
'32296007',
'32296009',
'32296010',
'32402006',
'32402008',
'32402011',
'32484002',
'32487004',
'32488001',
'32488018',
'32491001',
'32491010',
'32498004',
'32498005',
'32498007',
'32498008',
'32498010',
'32498012',
'32689021',
'32689023',
'32689051',
'32689057',
'32689067',
'32689071',
'32690024',
'32690033',
'32690051',
'32690060',
'32691006',
'32691007',
'32691010',
'32691047',
'32691050',
'32693004',
'32696001',
'32697001',
'53388075',
'53396008',
'53403014',
'53403015',
'53403021',
'53403023',
'53403025'];
echo count($listasocios).'<br>';
foreach ($listasocios as $i=>$item) { 
  $listasocios[$i]=str_pad($item, 8, "0", STR_PAD_LEFT);
}
$raw2=DB::raw("(select  count(ma.id_aporte)   from finanzas.aps_tr_maestro ma,finanzas.aps_aportes a 
where ma.id_aporte = a.id_aporte and ma.par_estado= 'A' AND ma.eliminado = 'N' 
and ma.par_tipo_op_aporte = 'ABONO' and a.id_persona=numero_papeleta) as total");
$raw=DB::raw("(select  sum(ma.importe)   from finanzas.aps_tr_maestro ma,finanzas.aps_aportes a 
where ma.id_aporte = a.id_aporte and ma.par_estado= 'A' AND ma.eliminado = 'N' 
and ma.par_tipo_op_aporte = 'ABONO' and a.id_persona=numero_papeleta) as totalap");
$raw3=DB::raw("(SELECT p.detalle
FROM global.parametros p
WHERE p.tipoparam= 'PAR_FUERZA' AND p.id_param=par_fuerza) as fuerza");
$salidasql=DB::connection('pgsql')->table('global.gbpersona')->select('numero_papeleta','par_fuerza','fecha_reg' ,'fecha_inscripcion','fecha_ingreso_trabajo','nombrecompleto','celular','teldom','telofi','email',$raw3,$raw2,$raw) 
        ->whereIn('numero_papeleta', $listasocios)
        ->get(); 

        foreach ($salidasql as $item) { 
            echo $item->numero_papeleta.'|'.$item->nombrecompleto.'|'.$item->fuerza.'|'.$item->celular.'|'.$item->teldom.'|'.$item->telofi.'|'.$item->email.'|'.$item->total.'|'.$item->totalap.'|'.$item->fecha_inscripcion.'|'.$item->fecha_ingreso_trabajo.'|'.$item->fecha_reg.'<br>';
          }
 
    }
    public function valueaportes(Request $request){
        // return DB::connection('dbcarga')->select("SELECT count(*) as suma  FROM finanzas.ptm_ascii where importe>100",array($request->socio))[0]->suma;
        $out = array();  
        $aportes = DB::connection('pgsql')->select("select  ma.fecha_transaccion,ma.importe , ma.detalle,(SELECT u.nombreusuario 
        FROM admsis.adusuario u
        WHERE u.usuario =ma.usuario_reg)as userreg ,ma.fecha_reg , a.id_producto
        from finanzas.aps_tr_maestro ma,finanzas.aps_aportes a 
        where ma.id_aporte = a.id_aporte and ma.par_estado= 'A' AND ma.eliminado = 'N' 
        and ma.par_tipo_op_aporte = 'ABONO' and a.id_persona=? order by ma.fecha_transaccion",array($request->socio));
        echo '<table border="1" style="border-spacing: 0;">
        <tr>
          <th>Fecha Transaccion</th>
          <th>Importe</th>
          <th>Detalle</th>
          <th>Usuario Reg</th>
          <th>Fecha Reg</th>
          <th>Producto</th>
        </tr>';
        foreach ($aportes as $item) { 
            echo '<tr><td>'.$item->fecha_transaccion.'</td><td>'.$item->importe.'</td><td>'.$item->detalle.'</td><td>'.$item->userreg.'</td><td>'.$item->fecha_reg.'</td><td>'.$item->id_producto.'</td></tr> ';
          }
        echo '</table>'; 

        }
}
